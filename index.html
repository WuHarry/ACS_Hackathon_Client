<!DOCTYPE html>
<html lang="en_US">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="">
    <title>Community Care System</title>
    <!-- bootstrap cdn -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!-- bootstrap js, jquery, popper cdn -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <!-- post get request -->
    <script src="inc/httpRequest.js"></script>
</head>
<body>
<ul class="nav justify-content-end">
    <li class="nav-item">
        <a class="nav-link active" href="#">Active</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#">Link</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#">Link</a>
    </li>
    <li class="nav-item">
        <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
    </li>
</ul>

<div class="container">
    <form>
        <div class="form-group">
            <label for="username">Email address</label>
            <input type="email" class="form-control" id="username"
                   aria-describedby="emailHelp">
            <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
        </div>
        <div class="form-group">
            <label for="password">Password</label>
            <input type="password" class="form-control" id="password">
        </div>
        
        <button type="submit" class="btn btn-primary" id="submit">Submit
        </button>
    </form>
</div>

<script>
    document.addEventListener("DOMContentLoaded", ()=> {
        document.querySelector("#submit").addEventListener("click", (e)=>{
            e.preventDefault();
            let username = document.querySelector('#username').value;
            let password = document.querySelector('#password').value;
            let authenticate = {
                username: username,
                password: password
            };

            let xhr = new HttpRequest();
            xhr.post("https://xiao.engineer/community/api/authenticate",
                authenticate, (err, response)=>{
                    console.log(response);
                    document.cookie = "access_token=";
                    document.cookie = "access_token="+response.access_token;

                    let xhr2 = new HttpRequest();
                    xhr2.get("https://xiao.engineer/community/api/listTask",
                        (err, response)=>{
                            console.log(response);
                        });
                });
        });


    });
</script>
</body>
<footer>
    <p>&copy; 2020 Stay at Home</p>
    <p>Made in Melbourne with love</p>

</footer>
</html>